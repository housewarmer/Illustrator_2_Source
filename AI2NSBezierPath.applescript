tell application "Adobe Illustrator"	#variable declarations	set compositeCode to "//AI To NSBezierPath ©2009 Mark McDonald" & return	set doc to current document	set selectedPath to entire path of selection of doc	set pathClosed to closed of selection of doc	set pointCount to count items of selectedPath	set pathBounds to geometric bounds of selection of doc	set localOrigin_x to (round (item 1 of pathBounds) * 1000) / 1000	set localOrigin_y to (round (item 4 of pathBounds) * 1000) / 1000		#initial point	set aPoint_x to (round (item 1 of anchor of item 1 of selectedPath) * 1000) / 1000 - localOrigin_x	set aPoint_y to (round (item 2 of anchor of item 1 of selectedPath) * 1000) / 1000 - localOrigin_y		set codeString to "[templatePath moveToPoint:NSMakePoint(" & aPoint_x & ", " & aPoint_y & ")];" & return	set compositeCode to compositeCode & codeString			#all following anchor points 	repeat with aPathPoint from 2 to pointCount		set leftPathPoint to item (aPathPoint - 1) of selectedPath		set rightPathPoint to item aPathPoint of selectedPath				set aPoint_x to (round (item 1 of anchor of rightPathPoint) * 1000) / 1000 - localOrigin_x		set aPoint_y to (round (item 2 of anchor of rightPathPoint) * 1000) / 1000 - localOrigin_y				set controlPoint1_x to (round (item 1 of right direction of leftPathPoint) * 1000) / 1000 - localOrigin_x		set controlPoint1_y to (round (item 2 of right direction of leftPathPoint) * 1000) / 1000 - localOrigin_y				set controlPoint2_x to (round (item 1 of left direction of rightPathPoint) * 1000) / 1000 - localOrigin_x		set controlPoint2_y to (round (item 2 of left direction of rightPathPoint) * 1000) / 1000 - localOrigin_y				set codeString to (("[templatePath curveToPoint:NSMakePoint(" & aPoint_x) & ", " & aPoint_y) & ") controlPoint1:NSMakePoint(" & controlPoint1_x & ", " & controlPoint1_y & ") controlPoint2:NSMakePoint(" & controlPoint2_x & ", " & controlPoint2_y & ")];" & return		set compositeCode to compositeCode & codeString	end repeat		#for closed paths	if pathClosed is true then		set leftPathPoint to item (pointCount) of selectedPath		set rightPathPoint to item 1 of selectedPath				set aPoint_x to (round (item 1 of anchor of rightPathPoint) * 1000) / 1000 - localOrigin_x		set aPoint_y to (round (item 2 of anchor of rightPathPoint) * 1000) / 1000 - localOrigin_y				set controlPoint1_x to (round (item 1 of right direction of leftPathPoint) * 1000) / 1000 - localOrigin_x		set controlPoint1_y to (round (item 2 of right direction of leftPathPoint) * 1000) / 1000 - localOrigin_y				set controlPoint2_x to (round (item 1 of left direction of rightPathPoint) * 1000) / 1000 - localOrigin_x		set controlPoint2_y to (round (item 2 of left direction of rightPathPoint) * 1000) / 1000 - localOrigin_y				set codeString to (("[templatePath curveToPoint:NSMakePoint(" & aPoint_x) & ", " & aPoint_y) & ") controlPoint1:NSMakePoint(" & controlPoint1_x & ", " & controlPoint1_y & ") controlPoint2:NSMakePoint(" & controlPoint2_x & ", " & controlPoint2_y & ")];" & return		set compositeCode to compositeCode & codeString	end ifend tellset the clipboard to compositeCode